{
  "hash": "168a3ebe1de357b4e6a27995120ae9c2",
  "result": {
    "markdown": "---\ntitle: \"Parametric survival distributions\"\nbibliography: references.bib\nformat:\n  html:\n    code-copy: true\neditor_options: \n  chunk_output_type: console\n---\n\n\n## Introduction\n\nThere are a wide range of parametric models available, and each have their own characteristics which make them suitable for different data sets. Exponential, Weibull, Gompertz, log-logistic, log normal and Generalised Gamma parametric models should all be considered. These models, and methods to assess which of these models are suitable for particular data sets are described below. Further details on the properties of the individual parametric models that should be considered can be found in [@Collett2013], including diagrams of hazard, survivor and probability density functions which show the variety of shapes that the different models can take, depending upon their parameters. The hazard function is the event rate at time t conditional upon survival until time $t$. The survivor function is the probability that the survival time is greater than or equal to time $t$.\n\nGeneral equations for survival analysis are the following. The hazard is given by\n\n\n$$\nh(t) = \\frac{f(t)}{S(t)}\n$$\n\n\nThe survival (or survivor) curve is\n\n\n$$\nS(t) = 1 - F(t) = \\int_t^{\\infty} f(t) \\; \\mbox{d}t\n$$\n\n\n\nand the cumulative hazard is given by\n\n\n$$\nH(t) = \\int h(t) \\; \\mbox{d}t\n$$\n\n\nwhere $f(t)$ is the density function, and $F(t)$ is the cumulative distribution function.\n\n\nWe now introduce the separate functions for the most common distributions.\n\n## Exponential\n\nThe hazard is constant i.e.\n\n\n$$\nh(t) = \\lambda\n$$\n\n\nand this then corresponds to\n\n\n$$\nS(t) = \\exp \\left(- \\int \\lambda \\;\\mbox{d}t \\right) = e^{-\\lambda t}\n$$\n\n\nIn R random samples from the exponential distribution can be obtained using `rexp` e.g. make 10 draws using `rexp(n = 10, rate = 2)`. The other functions are `pexp` fore the cumulative distribution, `qexp` is the quantile function and density is `dexp`.\n\nWe can easily view a curve as follows.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncurve(dexp(x, rate = 0.5), from=0, to=10, col='blue')\n```\n\n::: {.cell-output-display}\n![](distributions_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nFor the following we will also give an example density plot.\nWhere there is a base R function available to do this we will use this.\nIf not the we will use the equivalent functions from the `flexsurv` package.\n\n\n## Weibull\n\nHazard\n\n\n$$\nh(t) = \\lambda \\gamma t^{\\gamma-1}\n$$\n\n\nSurvival function\n\n\n$$\nS(t) = \\exp \\left( - \\int_0^t \\lambda \\gamma u^{\\gamma-1} \\; \\mbox{d}u \\right) = \\exp(- \\lambda t^{\\gamma})\n$$\n\n::: {.cell}\n\n```{.r .cell-code}\ncurve(dweibull(x, shape = 2, scale = 4), from=0, to=10, col='blue')\n```\n\n::: {.cell-output-display}\n![](distributions_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n## Gompertz\n\nHazard function\n\n\n$$\nh(t) = \\lambda e^{\\theta t}\n$$\n\n\nSurvival functions\n\n\n$$\nS(t) = \\exp \\left( \\frac{\\lambda}{\\theta} \\left(1 - e^{\\theta t} \\right) \\right)\n$$\n\n::: {.cell}\n\n```{.r .cell-code}\ncurve(flexsurv::dgompertz(x, shape = 0.3, rate = 0.25), from=0, to=10, col='blue')\n```\n\n::: {.cell-output-display}\n![](distributions_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n## Log-Logistic\n\nHazard function\n\n\n$$\nh(t) =  \\frac{e^{\\theta} \\kappa t^{\\kappa - 1}}{1 + e^{\\theta} t^{\\kappa}}\n$$\n\n\nSurvival function\n\n\n$$\nS(t) = \\left( 1 + e^{\\theta} t^{\\kappa} \\right)^{-1}\n$$\n\n::: {.cell}\n\n```{.r .cell-code}\ncurve(flexsurv::dllogis(x, shape = 3, log = TRUE), from=0, to=10, col='blue')\n```\n\n::: {.cell-output-display}\n![](distributions_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## Log normal\n\nSurvival function\n\n\n$$\nS(t) = 1 - \\Phi\\left( \\frac{\\log t - \\mu}{\\sigma} \\right)\n$$\n\n::: {.cell}\n\n```{.r .cell-code}\ncurve(dlnorm(x, meanlog = 2, sdlog = 0.5), from=0, to=10, col='blue')\n```\n\n::: {.cell-output-display}\n![](distributions_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## Generalised Gamma\n\nSurvival function\n\n\n$$\nS(t) = 1 - \\Gamma_{\\lambda t}^{\\theta} (\\rho)\n$$\n\n\nwhere $\\Gamma_{\\lambda t} (\\rho)$ is the incomplete gamma function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncurve(flexsurv::dgengamma(x, mu = 5, sigma = 2, Q = 0.1), from=0, to=10, col='blue')\n```\n\n::: {.cell-output-display}\n![](distributions_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "distributions_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
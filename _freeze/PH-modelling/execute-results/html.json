{
  "hash": "000e8da6848e1179ca055996f889deba",
  "result": {
    "markdown": "---\ntitle: \"Proportional Hazard Modelling\"\nbibliography: references.bib\nformat:\n  html:\n    code-copy: true\neditor_options: \n  chunk_output_type: console\n---\n\n\n# Introduction\n\nThe purpose of the CPH model is to evaluate simultaneously the effect of several factors on survival. It allows us to examine how specified factors influence the rate of a particular event happening at a particular point in time. This rate is commonly referred as the _hazard rate_.\n\nThe Cox model is expressed by the hazard function denoted by $h(t)$. The hazard function can be interpreted as the risk of dying at time $t$.\n\nIt can be estimated as follow:\n\n\n$$\nh(t) = h_0(t) \\times \\exp (\\beta_1 x_1 + \\beta_2 x_2 + \\cdots + \\beta_p x_p)\n$$\n\nwhere\n\n* $h_0$ is the _baseline hazard_ corresponding to the value of the hazard if all of the $x_i$ are equal to zero.\n* Each $\\exp(\\beta_i)$ are the _hazard ratios_. Id HR < 1the there is a reduction in the hazard and if HR > 1 then there is an increase in the hazard.\n\n\n## Example in R\n\nWe will use the standard package `survival` for this and the package `survminer` which has some nice plotting functions.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"survival\")\nlibrary(\"survminer\")\n```\n:::\n\n\nLoad the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"lung\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in data(\"lung\"): data set 'lung' not found\n```\n:::\n\n```{.r .cell-code}\nhead(lung)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  inst time status age sex ph.ecog ph.karno pat.karno meal.cal wt.loss\n1    3  306      2  74   1       1       90       100     1175      NA\n2    3  455      2  68   1       0       90        90     1225      15\n3    3 1010      1  56   1       0       90        90       NA      15\n4    5  210      2  57   1       1       90        60     1150      11\n5    1  883      2  60   1       0      100        90       NA       0\n6   12 1022      1  74   1       1       50        80      513       0\n```\n:::\n:::\n\n\nand compute a univariate Cox model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres.cox <- coxph(Surv(time, status) ~ sex, data = lung)\nsummary(res.cox)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\ncoxph(formula = Surv(time, status) ~ sex, data = lung)\n\n  n= 228, number of events= 165 \n\n       coef exp(coef) se(coef)      z Pr(>|z|)   \nsex -0.5310    0.5880   0.1672 -3.176  0.00149 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n    exp(coef) exp(-coef) lower .95 upper .95\nsex     0.588      1.701    0.4237     0.816\n\nConcordance= 0.579  (se = 0.021 )\nLikelihood ratio test= 10.63  on 1 df,   p=0.001\nWald test            = 10.09  on 1 df,   p=0.001\nScore (logrank) test = 10.33  on 1 df,   p=0.001\n```\n:::\n:::\n\n\nFor a multivariate Cox model it is a simple extension\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres.cox <- coxph(Surv(time, status) ~ age + sex + ph.ecog, data =  lung)\nsummary(res.cox)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\ncoxph(formula = Surv(time, status) ~ age + sex + ph.ecog, data = lung)\n\n  n= 227, number of events= 164 \n   (1 observation deleted due to missingness)\n\n             coef exp(coef)  se(coef)      z Pr(>|z|)    \nage      0.011067  1.011128  0.009267  1.194 0.232416    \nsex     -0.552612  0.575445  0.167739 -3.294 0.000986 ***\nph.ecog  0.463728  1.589991  0.113577  4.083 4.45e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n        exp(coef) exp(-coef) lower .95 upper .95\nage        1.0111     0.9890    0.9929    1.0297\nsex        0.5754     1.7378    0.4142    0.7994\nph.ecog    1.5900     0.6289    1.2727    1.9864\n\nConcordance= 0.637  (se = 0.025 )\nLikelihood ratio test= 30.5  on 3 df,   p=1e-06\nWald test            = 29.93  on 3 df,   p=1e-06\nScore (logrank) test = 30.5  on 3 df,   p=1e-06\n```\n:::\n:::\n\n\nWe can visualise the output as follows.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit <- survfit(Surv(time, status) ~ sex, data = lung)\n\n# base R\nplot(fit)\n\n# ggplot2\nggsurvplot(fit, conf.int = TRUE,\n           ggtheme = theme_minimal(), data = lung)\n```\n\n::: {.cell-output-display}\n![](PH-modelling_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](PH-modelling_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n:::\n",
    "supporting": [
      "PH-modelling_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}